<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>HistoryWindow.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">HappyShop</a> &gt; <a href="index.source.html" class="el_package">ci553.happyshop.client.warehouse</a> &gt; <span class="el_source">HistoryWindow.java</span></div><h1>HistoryWindow.java</h1><pre class="source lang-java linenums">package ci553.happyshop.client.warehouse;

import ci553.happyshop.utility.UIStyle;
import ci553.happyshop.utility.WindowBounds;
import javafx.scene.Scene;
import javafx.scene.control.TextArea;
import javafx.scene.layout.VBox;
import javafx.stage.Stage;
import java.util.ArrayList;

/**
 * This class provides a simple history window to display a list of events (successfully delete, edit and add a new product).
 *
 * - The scene is created only once to avoid unnecessary scene recreation.
 * - The window is created only when needed. If the window is already visible, it will not be recreated.
 * - The history text is updated dynamically in the TextArea when new data is provided.
 * - The window is positioned relative to the warehouse window for a consistent UI experience.
 *
 * This design ensures that the history view is efficient by not recreating the scene and only displaying the window when required.
 */

<span class="nc" id="L22">public class HistoryWindow {</span>
<span class="nc" id="L23">    private static int WIDTH = UIStyle.HistoryWinWidth;</span>
<span class="nc" id="L24">    private static int HEIGHT = UIStyle.HistoryWinHeight;</span>

    public WarehouseView warehouseView;
<span class="nc" id="L27">    private  Stage window = new Stage();</span>
    private  Scene scene;
    private  TextArea taHistory;

    // Create the scene only once (to avoid recreating it multiple times)
    private  void createScene() {
        // a TextArea to show stock management history
<span class="nc" id="L34">        taHistory = new TextArea();</span>
<span class="nc" id="L35">        taHistory.setPrefSize(150,150);</span>
<span class="nc" id="L36">        taHistory.setEditable(false);</span>
<span class="nc" id="L37">        taHistory.setStyle(UIStyle.textFiledStyle);</span>
<span class="nc" id="L38">        VBox vbHistory = new VBox(taHistory);</span>
<span class="nc" id="L39">        scene = new Scene(vbHistory,WIDTH,HEIGHT);</span>
<span class="nc" id="L40">    }</span>

    // Create the window only when needed (i.e., when the window is not created or closed by user but we need it again)
    private  void createWindow(){
<span class="nc bnc" id="L44" title="All 2 branches missed.">        if (scene == null) {</span>
<span class="nc" id="L45">            createScene(); // create the scene only once</span>
        }

<span class="nc" id="L48">        window = new Stage();</span>
<span class="nc" id="L49">        window.setScene(scene);</span>
<span class="nc" id="L50">        window.setTitle(&quot;\uD83C\uDFEC Warehouse Management History&quot;); // for icon üè¨</span>
<span class="nc" id="L51">        window.show();</span>
        //get the bounds of warehouse window which trigers the history window
        //so that we can put the history window next to the warehouse window
<span class="nc" id="L54">        WindowBounds bounds = warehouseView.getWindowBounds();</span>
<span class="nc" id="L55">        window.setX(bounds.x + bounds.width - 20);</span>
<span class="nc" id="L56">        window.setY(bounds.y); // align vertically</span>
<span class="nc" id="L57">    }</span>

    public  void showManageHistory(ArrayList&lt;String&gt; history){
<span class="nc bnc" id="L60" title="All 4 branches missed.">        if(window ==null ||!window.isShowing() ) {</span>
<span class="nc" id="L61">            createWindow();  // Only create window if it's not created or unvisible</span>
        }
        // Create a single string with each item on a new line
<span class="nc" id="L64">        StringBuilder result = new StringBuilder();</span>
<span class="nc bnc" id="L65" title="All 2 branches missed.">        for (String his : history) {</span>
<span class="nc" id="L66">            result.append(his).append(&quot;\n&quot;); // Append item followed by a newline</span>
<span class="nc" id="L67">        }</span>
<span class="nc" id="L68">        taHistory.setText(result.toString());</span>
<span class="nc" id="L69">        System.out.println(result.toString());</span>
<span class="nc" id="L70">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.13.202504020838</span></div></body></html>